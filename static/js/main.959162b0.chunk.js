(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{230:function(e,t,n){e.exports=n(402)},235:function(e,t,n){},282:function(e,t){},284:function(e,t){},295:function(e,t){},297:function(e,t){},324:function(e,t){},326:function(e,t){},327:function(e,t){},333:function(e,t){},335:function(e,t){},353:function(e,t){},356:function(e,t){},372:function(e,t){},375:function(e,t){},402:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(13),u=n.n(o),c=(n(235),n(211)),i=n(20),l=n(45),s=n.n(l),p=n(69),d=n(92),h=n(93),m=n(104),f=n(103),b=n(446),g=n(453),v=n(454),k=n(108),E=n(8),x=n(49),y=n.n(x),S=n(212),w=n(25),C=n(107),I=n.n(C),O=n(130),D=n.n(O),j=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={title:"",author:"",pages:"",description:"",edition:"",year:"",language:"",publisher:"",isbn:"",issn:"",courseDepartment:"",courseCode:""},e}return Object(h.a)(n,[{key:"getMd5",value:function(){var e=Object(p.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var a=new FileReader;a.onloadend=function(t){var n=D.a.lib.WordArray.create(a.result);e(D.a.MD5(n).toString())},a.onerror=function(e){n(e)},a.readAsArrayBuffer(t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"formSubmit",value:function(){var e=Object(p.a)(s.a.mark((function e(t){var n,a,r,o,u,c,i,l,d,h,m,f,b,g,v,k,E,x,w,C;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=new FormData,a=document.getElementById("file"),n.append("file",a.files[0]),e.next=6,this.getMd5(a.files[0]);case 6:return r=e.sent,o=this.state,u=o.title,c=o.author,i=o.pages,l=o.description,d=o.edition,h=o.year,m=o.publisher,f=o.isbn,b=o.issn,g=o.courseDepartment,v=o.courseCode,k=o.language,E={title:u,author:c,pages:i,description:l,edition:d,year:h,publisher:m,isbn:f,issn:b,courseDepartment:g,courseCode:v,language:k},e.prev=9,e.next=12,y.a.get("https://cors-anywhere.herokuapp.com/http://gen.lib.rus.ec/book/index.php?md5=".concat(r));case 12:if(200!==e.sent.status){e.next=39;break}return console.log("Already on libgen."),e.next=17,y.a.get("https://sbutextbooks.herokuapp.com/books");case 17:x=e.sent,w=Object(S.a)(x.data.textbooks),e.prev=19,w.s();case 21:if((C=w.n()).done){e.next=27;break}if(C.value.md5!==r){e.next=25;break}return e.abrupt("return");case 25:e.next=21;break;case 27:e.next=32;break;case 29:e.prev=29,e.t0=e.catch(19),w.e(e.t0);case 32:return e.prev=32,w.f(),e.finish(32);case 35:return E={title:u,author:c,pages:i,description:l,edition:d,year:h,publisher:m,isbn:f,issn:b,courseDepartment:g,courseCode:v,language:k,md5:r},e.next=38,y()({method:"POST",url:"https://sbutextbooks.herokuapp.com/upload",data:I.a.stringify(E)});case 38:return e.abrupt("return");case 39:e.next=44;break;case 41:e.prev=41,e.t1=e.catch(9),console.log("not found on libgen... uploading...");case 44:y()({method:"POST",url:"https://cors-anywhere.herokuapp.com/https://library.bz/main/upload/",data:n,headers:{"Content-Type":"multipart/form-data"},auth:{username:"genesis",password:"upload"}}).then((function(e){var t=e.headers["x-final-url"];t="https://cors-anywhere.herokuapp.com/".concat(t),y()({url:t,method:"POST",auth:{username:"genesis",password:"upload"},data:I.a.stringify(E)}).then(function(){var e=Object(p.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.data.toString().includes("The record has been successfully saved.")||t.data.toString().includes("The file is already in the upload queue and awaiting moderation")){e.next=4;break}alert("Upload failed!"),e.next=7;break;case 4:return E={title:u,author:c,pages:i,description:l,edition:d,year:h,publisher:m,isbn:f,issn:b,courseDepartment:g,courseCode:v,language:k,md5:r},e.next=7,y()({method:"POST",url:"https://sbutextbooks.herokuapp.com/upload",data:I.a.stringify(E)});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})).catch((function(e){console.log(e)}));case 45:case"end":return e.stop()}}),e,this,[[9,41],[19,29,32,35]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{margin:"2em"}},r.a.createElement(w.Form,{onSubmit:function(t){return e.formSubmit(t)}},r.a.createElement("legend",null,"Upload a Textbook"),r.a.createElement(w.Input,{id:"file",type:"file"}),r.a.createElement(w.Input,{label:"Title*",onChange:function(t){return e.setState({title:t.target.value})},placeholder:"Title",required:!0}),r.a.createElement(w.Input,{label:"Author*",onChange:function(t){return e.setState({author:t.target.value})},placeholder:"Author",required:!0}),r.a.createElement(w.Input,{label:"Page Count",onChange:function(t){return e.setState({pages:t.target.value})},placeholder:"Page Count"}),r.a.createElement(w.Textarea,{label:"Description",onChange:function(t){return e.setState({description:t.target.value})},placeholder:"Description (optional)"}),r.a.createElement(w.Input,{label:"Edition*",onChange:function(t){return e.setState({edition:t.target.value})},placeholder:"ex. 1st, 2nd, 5th, etc.",required:!0}),r.a.createElement(w.Input,{label:"Language*",onChange:function(t){return e.setState({language:t.target.value})},placeholder:"Language",required:!0}),r.a.createElement(w.Input,{label:"Release Year",onChange:function(t){return e.setState({year:t.target.value})},placeholder:"Release Year"}),r.a.createElement(w.Input,{label:"Publisher",onChange:function(t){return e.setState({publisher:t.target.value})},placeholder:"Publisher"}),r.a.createElement(w.Input,{label:"ISBN*",onChange:function(t){return e.setState({isbn:t.target.value})},placeholder:"ISBN",required:!0}),r.a.createElement(w.Input,{label:"ISSN",onChange:function(t){return e.setState({issn:t.target.value})},placeholder:"ISSN"}),r.a.createElement(w.Input,{label:"Course Department",onChange:function(t){return e.setState({courseDepartment:t.target.value})},placeholder:"ex. AMS, CSE, BIO, etc.",required:!0}),r.a.createElement(w.Input,{label:"Course Code",onChange:function(t){return e.setState({courseCode:t.target.value})},placeholder:"ex. 101, 300, etc.",required:!0}),r.a.createElement(w.Button,{variant:"raised"},"Submit")))}}]),n}(r.a.Component),T=[{name:"course",title:"Course"},{name:"textbook",title:"Textbook"},{name:"linkInfo",title:"Download"}],A=function(e){var t=e.value;return r.a.createElement("span",null,r.a.createElement("a",{href:"http://gen.lib.rus.ec/book/index.php?md5=".concat(t.md5)},"Download "),r.a.createElement("a",{href:"https://library.bz/main/uploads/".concat(t.md5),style:{visibility:"".concat(t.age<1728e5?"visible":"hidden"),fontSize:"0.8em"}},"(alternate download)"))},P=function(e){return r.a.createElement(E.b,Object.assign({formatterComponent:A},e))},q=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={textbooks:[],search:"",loaded:!1},e}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(p.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://sbutextbooks.herokuapp.com/books",e.next=3,y.a.get("https://sbutextbooks.herokuapp.com/books");case 3:t=e.sent,this.setState({textbooks:t.data.textbooks.map((function(e){return{course:e.course.toUpperCase(),textbook:"".concat(e.title," (").concat(e.edition," edition),\n                               ").concat(e.author),linkInfo:{md5:e.md5,age:Date.now()-new Date(e.createdAt).getTime()}}}))}),this.setState({loaded:!0});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.loaded?r.a.createElement("div",{style:{margin:"2em"}},r.a.createElement(g.a,{options:this.state.textbooks.map((function(e){return e.course})).sort(),renderInput:function(t){return r.a.createElement(v.a,Object.assign({},t,{label:"Course",variant:"outlined",onChange:function(t){return e.setState({search:t.target.value})}}))}}),r.a.createElement("button",null,"Upload"),r.a.createElement(b.a,null,r.a.createElement(k.a,{rows:this.state.textbooks.filter((function(t){return t.course.includes(e.state.search.toUpperCase())})),columns:T},r.a.createElement(E.k,{defaultSorting:[{columnName:"course",direction:"asc"}]}),r.a.createElement(E.h,null),r.a.createElement(P,{for:["linkInfo"]}),r.a.createElement(k.b,null),r.a.createElement(k.c,null)))):r.a.createElement("span",null,"Loading...")}}]),n}(r.a.Component);var B=function(){return r.a.createElement(c.a,null,r.a.createElement("div",{className:"App"},r.a.createElement(i.c,null,r.a.createElement(i.a,{exact:!0,path:"/",component:q}),r.a.createElement(i.a,{path:"/upload",component:j}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(B,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[230,1,2]]]);
//# sourceMappingURL=main.959162b0.chunk.js.map